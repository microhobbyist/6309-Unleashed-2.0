LISTING FOR LOGIC DESCRIPTION FILE: IOdecode.pld                     Page 1

CUPL(WM): Universal Compiler for Programmable Logic
Version 5.0a Serial# MW-10400000
Copyright (c) 1983, 1998 Logical Devices, Inc.
Created Sun Nov 16 21:42:17 2025

  1:Name     IODecode ;
  2:PartNo   ATF22V10C ;
  3:Date     2025/11/09 ;
  4:Revision 6         ;
  5:Designer Frederic Segard ;
  6:Company  MicroHobbyist ;
  7:Assembly None ;
  8:Location None ;
  9:Device   g22v10 ;
 10:
 11:/* =========================================================
 12:   Compiler Options
 13:   ---------------------------------------------------------
 14:   cupl -m2lxfjanb -u C:\Wincupl\Shared\Atmel.DL %1.PLD
 15:   ========================================================= */
 16:
 17:/* =========================================================
 18:   DYNAMIC WAIT-STATE DECODER (TRISTATE, +1 RULE)
 19:   ---------------------------------------------------------
 20:   - WS bus pulled down externally.
 21:   - Only drives WS1/WS2 when AnyCS=1.
 22:   - SPDsel = 0 -> 3 MHz, base WS
 23:              1 -> 5 MHz, adds +1 WS globally
 24:   - WS encoding (2 bits):
 25:        WS2 WS1 | Meaning
 26:        0   0   | 0 WS
 27:        0   1   | 1 WS
 28:        1   0   | 2 WS
 29:        1   1   | 3 WS  (max)
 30:   ========================================================= */
 31:
 32:PIN 1  =  E         ; /* CPU E (data phase) */
 33:PIN 2  = !IORQ      ; /* I/O Request, Active-low during I/O cycle */
 34:PIN 3  =  WSsel     ; /* The red LED indicates the high speed */
 35:PIN 4  =  A0        ; /* Address bit 0 - LSB */
 36:PIN 5  =  A1        ;
 37:PIN 6  =  A2        ;
 38:PIN 7  =  A3        ;
 39:PIN 8  =  A4        ;
 40:PIN 9  =  A5        ;
 41:PIN 10 =  A6        ;
 42:PIN 11 =  A7        ; /* Address bit 7 - MSB of I/O window */
 43:/*  12 =  GND       ; /* Ground connection */
 44:/*  13 =  GND       ; /* Grounded so not to tristate the outputs */
 45:
 46:/*  24 =  VCC       ; /* +5V connection */
 47:PIN 23 = !TIMERcs   ; /* WS: 0,2 $FF00-07, Timer (HD63B40) */
 48:PIN 22 = !CFcs      ; /* WS: 1,3 $FF08-0F, Compact Flash card */
 49:PIN 21 = !ACIAcs    ; /* WS: 0,1 $FF10-13, ACIA (R65C51R4) */
 50:PIN 20 = !RTCcs     ; /* WS: 0,1 $FF14-15, Realtime clock (DS12C887A) */
 51:PIN 19 =  RTCas     ; /* WS: 0,1 $FF14,    RTCs Address Strobe */
 52:PIN 18 =  RTCds     ; /* WS: 0,1 $FF15,    RTCs Data Strobe */
 53:PIN 17 =  AnyCS     ; /* Any one of the chip selects [feedback pin] */

LISTING FOR LOGIC DESCRIPTION FILE: IOdecode.pld                     Page 2

CUPL(WM): Universal Compiler for Programmable Logic
Version 5.0a Serial# MW-10400000
Copyright (c) 1983, 1998 Logical Devices, Inc.
Created Sun Nov 16 21:42:17 2025

 54:PIN 16 =  WS0       ;
 55:PIN 15 =  WS1       ; /* Multiplexed Waitstate level (Tristate)*/
 56:PIN 14 =  WS2       ;
 57:
 58:IOBASE  = !A7 & !A6 & !A5 & IORQ & E ;
 59:
 60:TIMERcs = IOBASE & !A4 & !A3 ;                    /* 8 : $00-$07 */
 61:CFcs    = IOBASE & !A4 &  A3 ;                    /* 8 : $08-$0F */
 62:ACIAcs  = IOBASE &  A4 & !A3 & !A2 ;              /* 4 : $10-$13 */
 63:RTCcs   = IOBASE &  A4 & !A3 &  A2 & !A1 ;        /* 2 : $14-$15 */
 64:RTCas   = IOBASE &  A4 & !A3 &  A2 & !A1 & !A0 ;  /*   : $14     */
 65:RTCds   = IOBASE &  A4 & !A3 &  A2 & !A1 &  A0 ;  /*   : $15     */
 66:
 67:/* =========================================================
 68:   WAIT-STATE LOGIC
 69:   ========================================================= */
 70:FIELD CS = [!TIMERcs, !ACIAcs, !RTCcs, !CFcs, WSsel] ;
 71:FIELD WS = [WS2,WS1,WS0] ;
 72:TABLE CS => WS {
 73:/* Slow mode (speed=0) */
 74:'b'00000 => 'b'000;
 75:'b'10000 => 'b'001;
 76:'b'01000 => 'b'000;
 77:'b'00100 => 'b'000;
 78:'b'00010 => 'b'010;
 79:/* Fast mode (speed=1) */
 80:'b'00001 => 'b'000;
 81:'b'10001 => 'b'011;
 82:'b'01001 => 'b'001;
 83:'b'00101 => 'b'001;
 84:'b'00011 => 'b'100;
 85:}
 86:
 87:/* Combine selects */
 88:AnyCS = TIMERcs # ACIAcs # RTCcs # CFcs ;
 89:
 90:/* --- Tri-state outputs when idle --- */
 91:WS0.oe = AnyCS ;
 92:WS1.oe = AnyCS ;
 93:WS2.oe = AnyCS ;
 94:
 95:



Jedec Fuse Checksum       (8b10)
Jedec Transmit Checksum   (df88)
